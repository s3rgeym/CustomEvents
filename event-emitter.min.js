function EventEmitter(){this._listeners={}}EventEmitter.prototype={on:function(e,t,s,n){return(this._hasListeners(e)?this._listeners[e]:this._listeners[e]=[]).push({fn:t,scope:null!=s?s:this,once:n}),this},once:function(e,t,s){return this.on(e,t,s,!0)},off:function(e,t,s){if(arguments.length){if(1==arguments.length)this._hasListeners(e)&&delete this._listeners[e];else if(this._hasListeners(e)){for(var n=this._listeners[e],i=0;i<n.length;){var r=n[i];t!==r.fn||null!=s&&s!==r.scope?++i:n.splice(i,1)}n.length||delete this._listeners[e]}}else this._listeners={};return this},emit:function(e,t){if(this._hasListeners(e)){t=[].slice.call(arguments,1);for(var s=this._listeners[e],n=0;n<s.length;){var i=s[n];i.fn.apply(i.scope,t),i.once?s.splice(n,1):++n}s.length||delete this._listeners[e]}},_hasListeners:function(e){return this._listeners.hasOwnProperty(e)}},EventEmitter.mixin=function(e){"function"==typeof e&&(e=e.prototype);var t=new EventEmitter;for(var s in t)e[s]=t[s];return e};